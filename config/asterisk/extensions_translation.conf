; Real-Time Translation Dialplan for FreePBX
; Routes calls through GPU translation service at 192.168.1.178:4000
;
; Usage: Dial 8XXX to translate to extension XXX
; Example: Dial 8100 to call extension 100 with English->Spanish translation

[translation-context]
; Translation prefix: 8XXX
exten => _8XXX,1,NoOp(=== TRANSLATION CALL TO ${EXTEN:1} ===)
 same => n,Set(TARGET_EXTEN=${EXTEN:1})
 same => n,Set(TRANSLATION_SERVER=192.168.1.178)
 same => n,Set(TRANSLATION_PORT=4000)
 same => n,Answer()
 same => n,NoOp(Starting translation service)
 same => n,ExternalMedia(rtp:${TRANSLATION_SERVER}:${TRANSLATION_PORT})
 same => n,Dial(PJSIP/${TARGET_EXTEN},30)
 same => n,Hangup()

; Direct translation test - dial 8888
exten => 8888,1,NoOp(=== TRANSLATION TEST ===)
 same => n,Set(TRANSLATION_SERVER=192.168.1.178)
 same => n,Set(TRANSLATION_PORT=4000)
 same => n,Answer()
 same => n,Playback(hello-world)
 same => n,NoOp(Connecting to translation service)
 same => n,ExternalMedia(rtp:${TRANSLATION_SERVER}:${TRANSLATION_PORT})
 same => n,Wait(10)
 same => n,Hangup()

; Emergency bypass - dial 9XXX to call without translation
exten => _9XXX,1,NoOp(=== DIRECT CALL TO ${EXTEN:1} ===)
 same => n,Set(TARGET_EXTEN=${EXTEN:1})
 same => n,Dial(PJSIP/${TARGET_EXTEN},30)
 same => n,Hangup()
